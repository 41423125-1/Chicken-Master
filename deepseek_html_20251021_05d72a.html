<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Roast Chicken Temperature Control Panel</title>
    <script src="https://cdn.jsdelivr.net/npm/brython@3/brython.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/brython@3/brython_stdlib.js"></script>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Arial, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a1a2e 0%, #162447 100%);
            color: #e6e6e6;
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .container {
            width: 100%;
            max-width: 1200px;
            background: rgba(22, 36, 71, 0.95);
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.5);
            overflow: hidden;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .panel {
            display: flex;
            min-height: 700px;
        }
        
        .left-section {
            flex: 1;
            display: flex;
            flex-direction: column;
            border-right: 2px solid #2d4059;
        }
        
        .right-section {
            flex: 1.3;
            display: flex;
            flex-direction: column;
        }
        
        .status-bar {
            background: linear-gradient(135deg, #0f3460 0%, #1f4068 100%);
            padding: 20px 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid #2d4059;
        }
        
        .app-title {
            font-weight: bold;
            font-size: 1.5rem;
            color: #e43f5a;
        }
        
        .current-time {
            font-size: 1.1rem;
            color: #b8b8b8;
        }
        
        .input-section {
            padding: 30px;
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
        }
        
        .input-group {
            display: flex;
            flex-direction: column;
            margin-bottom: 25px;
        }
        
        label {
            margin-bottom: 12px;
            font-weight: bold;
            color: #e6e6e6;
            font-size: 1.1rem;
        }
        
        input[type="number"] {
            padding: 15px;
            border: 2px solid #2d4059;
            border-radius: 10px;
            font-size: 1.1rem;
            background-color: #0f3460;
            color: #e6e6e6;
            transition: all 0.3s ease;
        }
        
        input[type="number"]:focus {
            border-color: #e43f5a;
            outline: none;
            box-shadow: 0 0 10px rgba(228, 63, 90, 0.3);
        }

        /* Recipe selection area */
        .recipe-selection {
            margin-bottom: 25px;
        }

        .recipe-title {
            font-weight: bold;
            color: #e6e6e6;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }

        .recipe-buttons {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }

        .recipe-btn {
            background: rgba(15, 52, 96, 0.7);
            border: 2px solid #2d4059;
            border-radius: 10px;
            padding: 15px;
            color: #e6e6e6;
            font-size: 0.95rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .recipe-btn:hover {
            background: rgba(31, 64, 104, 0.8);
            border-color: rgba(228, 63, 90, 0.5);
            transform: translateY(-2px);
        }

        .recipe-btn.active {
            background: rgba(228, 63, 90, 0.2);
            border-color: #e43f5a;
            color: #e43f5a;
            box-shadow: 0 0 15px rgba(228, 63, 90, 0.3);
        }

        .recipe-icon {
            font-size: 1.3rem;
            margin-bottom: 5px;
            display: block;
        }
        
        .calculate-btn {
            background: linear-gradient(135deg, #e43f5a 0%, #d32f4e 100%);
            color: white;
            border: none;
            padding: 16px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: bold;
            transition: all 0.3s ease;
            width: 100%;
            margin-top: 10px;
            box-shadow: 0 4px 15px rgba(228, 63, 90, 0.3);
        }
        
        .calculate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(228, 63, 90, 0.4);
        }
        
        .history-btn {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            border: none;
            padding: 14px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: bold;
            transition: all 0.3s ease;
            width: 100%;
            margin-top: 15px;
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
        }
        
        .history-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(52, 152, 219, 0.4);
        }
        
        .back-btn {
            background: linear-gradient(135deg, #95a5a6 0%, #7f8c8d 100%);
            color: white;
            border: none;
            padding: 14px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: bold;
            transition: all 0.3s ease;
            width: 100%;
            margin-top: 15px;
            display: none;
            box-shadow: 0 4px 15px rgba(149, 165, 166, 0.3);
        }
        
        .back-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(149, 165, 166, 0.4);
        }

        /* Control buttons style */
        .control-buttons {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            padding: 25px;
            border-top: 2px solid #2d4059;
            border-bottom: 2px solid #2d4059;
        }
        
        .control-btn {
            background: rgba(15, 52, 96, 0.7);
            border: 1px solid rgba(45, 64, 89, 0.5);
            border-radius: 10px;
            padding: 18px;
            color: #e6e6e6;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 80px;
        }
        
        .control-btn:hover {
            background: rgba(31, 64, 104, 0.8);
            border-color: rgba(228, 63, 90, 0.5);
            transform: translateY(-2px);
        }
        
        .btn-icon {
            font-size: 1.6rem;
            margin-bottom: 8px;
        }

        /* Icon control panel style */
        .icon-panel {
            background: rgba(15, 52, 96, 0.7);
            border-radius: 15px;
            padding: 20px;
            margin: 20px;
            border: 1px solid rgba(45, 64, 89, 0.5);
            flex: 1;
        }

        .icon-panel-title {
            text-align: center;
            font-size: 1.2rem;
            font-weight: bold;
            color: #e43f5a;
            margin-bottom: 20px;
        }

        .icon-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .icon-item {
            background: rgba(31, 64, 104, 0.8);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid rgba(45, 64, 89, 0.5);
        }

        .icon-item:hover {
            transform: translateY(-3px);
            border-color: rgba(228, 63, 90, 0.5);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }

        .icon-item.active {
            border-color: #e43f5a;
            box-shadow: 0 0 20px rgba(228, 63, 90, 0.3);
        }

        .icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
            display: block;
        }

        .icon-name {
            font-size: 1rem;
            font-weight: bold;
            color: #e6e6e6;
        }

        .icon-desc {
            font-size: 0.8rem;
            color: #b8b8b8;
            margin-top: 5px;
        }

        /* Icon colors */
        .icon-monitor { color: #4cd964; }
        .icon-recipe { color: #ff9500; }
        .icon-history { color: #5ac8fa; }
        .icon-settings { color: #ff3b30; }
        
        .results {
            padding: 20px 25px;
            background: rgba(31, 64, 104, 0.8);
            border-top: 2px solid #2d4059;
            flex: 1;
            overflow-y: auto;
        }
        
        .results h2 {
            color: #e43f5a;
            margin-bottom: 15px;
            text-align: center;
            font-size: 1.3rem;
        }
        
        .result-item {
            margin-bottom: 20px;
            padding: 18px;
            background: rgba(15, 52, 96, 0.7);
            border-radius: 10px;
            border: 1px solid rgba(45, 64, 89, 0.5);
        }
        
        .result-title {
            font-weight: bold;
            color: #e43f5a;
            margin-bottom: 12px;
            font-size: 1.1rem;
            border-bottom: 1px solid rgba(228, 63, 90, 0.3);
            padding-bottom: 8px;
        }
        
        .result-value {
            font-size: 0.95rem;
            line-height: 1.5;
            color: #e6e6e6;
        }
        
        .error {
            color: #ff6b6b;
            margin-top: 12px;
            display: none;
            background: rgba(15, 52, 96, 0.8);
            padding: 12px;
            border-radius: 8px;
            text-align: center;
            font-size: 1rem;
            border: 1px solid rgba(255, 107, 107, 0.3);
        }
        
        .marinade-details {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 15px;
        }
        
        .marinade-item {
            background: rgba(26, 26, 46, 0.8);
            padding: 12px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid rgba(45, 64, 89, 0.3);
        }
        
        .marinade-name {
            font-size: 0.8rem;
            color: #b8b8b8;
            margin-bottom: 5px;
        }
        
        .marinade-amount {
            font-size: 0.9rem;
            font-weight: bold;
            color: #e6e6e6;
        }
        
        .instructions-box {
            background: rgba(26, 26, 46, 0.8);
            padding: 15px;
            border-radius: 8px;
            margin-top: 10px;
            border-left: 4px solid #e43f5a;
        }
        
        .instructions-content {
            font-size: 0.85rem;
            line-height: 1.5;
            white-space: pre-line;
            color: #e6e6e6;
        }
        
        .history-section {
            display: none;
            padding: 20px 25px;
            background: rgba(31, 64, 104, 0.8);
            border-top: 2px solid #2d4059;
            flex: 1;
            overflow-y: auto;
        }
        
        .history-list {
            max-height: 400px;
            overflow-y: auto;
        }
        
        .history-item {
            background: rgba(15, 52, 96, 0.7);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 12px;
            border: 1px solid rgba(45, 64, 89, 0.5);
            border-left: 4px solid #3498db;
        }
        
        .history-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        
        .history-date {
            font-weight: bold;
            color: #3498db;
            font-size: 0.85rem;
        }
        
        .history-weight {
            color: #e6e6e6;
            font-size: 1rem;
            font-weight: bold;
        }
        
        .history-marinade {
            margin-top: 10px;
            padding: 10px;
            background: rgba(26, 26, 46, 0.6);
            border-radius: 6px;
        }
        
        .marinade-summary {
            font-size: 0.8rem;
            color: #b8b8b8;
            line-height: 1.4;
        }
        
        .no-history {
            text-align: center;
            color: #b8b8b8;
            font-style: italic;
            padding: 30px;
            font-size: 1rem;
        }
    </style>
</head>
<body onload="brython()">
    <div class="container">
        <div class="panel">
            <div class="left-section">
                <div class="status-bar">
                    <div class="app-title">Roast Chicken Control Panel</div>
                    <div class="current-time" id="current-time">22:10</div>
                </div>
                
                <div class="input-section">
                    <!-- Chicken weight input area -->
                    <div class="input-group">
                        <label for="chicken-weight">Chicken Weight (grams):</label>
                        <input type="number" id="chicken-weight" min="500" max="5000" step="100" placeholder="e.g. 1500" value="1500">
                    </div>

                    <!-- Recipe selection area -->
                    <div class="recipe-selection">
                        <div class="recipe-title">Select Marinade Recipe</div>
                        <div class="recipe-buttons">
                            <button class="recipe-btn active" id="recipe-classic">
                                <span class="recipe-icon">ğŸ—</span>
                                Classic Original
                            </button>
                            <button class="recipe-btn" id="recipe-spicy">
                                <span class="recipe-icon">ğŸŒ¶ï¸</span>
                                Spicy Flavor
                            </button>
                            <button class="recipe-btn" id="recipe-herbal">
                                <span class="recipe-icon">ğŸŒ¿</span>
                                Herbal Garlic
                            </button>
                            <button class="recipe-btn" id="recipe-sweet">
                                <span class="recipe-icon">ğŸ¯</span>
                                Honey Glazed
                            </button>
                        </div>
                    </div>
                    
                    <!-- Function buttons -->
                    <button class="calculate-btn" id="calculate-btn">Calculate Roasting Parameters</button>
                    <button class="history-btn" id="history-btn">View History</button>
                    <button class="back-btn" id="back-btn">Back to Main</button>
                    <div id="error-message" class="error">Please enter a valid chicken weight (500-5000 grams)</div>
                </div>

                <!-- Control buttons area -->
                <div class="control-buttons">
                    <button class="control-btn" id="start-btn">
                        <div class="btn-icon">ğŸ”¥</div>
                        <div>Start Roasting</div>
                    </button>
                    <button class="control-btn" id="temp-btn">
                        <div class="btn-icon">ğŸŒ¡ï¸</div>
                        <div>Adjust Temperature</div>
                    </button>
                    <button class="control-btn" id="timer-btn">
                        <div class="btn-icon">â±ï¸</div>
                        <div>Set Timer</div>
                    </button>
                    <button class="control-btn" id="recipe-btn">
                        <div class="btn-icon">ğŸ“‹</div>
                        <div>View Recipe</div>
                    </button>
                </div>

                <!-- Icon control panel -->
                <div class="icon-panel">
                    <div class="icon-panel-title">Function Menu</div>
                    <div class="icon-grid">
                        <!-- Monitor icon -->
                        <div class="icon-item active" id="icon-monitor">
                            <span class="icon icon-monitor">ğŸ“Š</span>
                            <div class="icon-name">Monitor</div>
                            <div class="icon-desc">Real-time Monitoring</div>
                        </div>
                        
                        <!-- Recipe icon -->
                        <div class="icon-item" id="icon-recipe">
                            <span class="icon icon-recipe">ğŸ“‹</span>
                            <div class="icon-name">Recipes</div>
                            <div class="icon-desc">Manage Cooking Recipes</div>
                        </div>
                        
                        <!-- History icon -->
                        <div class="icon-item" id="icon-history">
                            <span class="icon icon-history">â±ï¸</span>
                            <div class="icon-name">History</div>
                            <div class="icon-desc">View Operation Records</div>
                        </div>
                        
                        <!-- Settings icon -->
                        <div class="icon-item" id="icon-settings">
                            <span class="icon icon-settings">âš™ï¸</span>
                            <div class="icon-name">Settings</div>
                            <div class="icon-desc">System Configuration</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="right-section">
                <!-- Calculation results area - includes marinade recipe and roasting instructions -->
                <div id="results" class="results">
                    <h2>Roasting Calculation Results</h2>
                    <div class="result-item">
                        <div class="result-title">Marinade Recipe & Amounts</div>
                        <div id="marinade-result" class="result-value">Enter chicken weight and click calculate to view marinade recommendations</div>
                        <div class="marinade-details" id="marinade-details">
                            <!-- Marinade details will be dynamically generated by Brython -->
                        </div>
                    </div>
                    <div class="result-item">
                        <div class="result-title">Roasting Instructions</div>
                        <div class="instructions-box">
                            <div id="instructions-result" class="instructions-content">After calculation, detailed roasting instructions will be displayed, including temperature settings, time control, and preparation steps.</div>
                        </div>
                    </div>
                </div>
                
                <div id="history-section" class="history-section">
                    <h2>Roasting History</h2>
                    <div class="history-list" id="history-list">
                        <div class="no-history" id="no-history">No roasting history yet. Please calculate your first roasting parameters!</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="text/python">
        # å¯¼å…¥ Brython æ¨¡å—
        from browser import document, timer, window
        import math
        import random
        from datetime import datetime
        
        # è·å– DOM å…ƒç´ å¼•ç”¨
        current_time = document["current-time"]
        chicken_weight_input = document["chicken-weight"]
        calculate_btn = document["calculate-btn"]
        history_btn = document["history-btn"]
        back_btn = document["back-btn"]
        error_message = document["error-message"]
        results_div = document["results"]
        history_section = document["history-section"]
        history_list = document["history-list"]
        no_history = document["no-history"]
        marinade_result = document["marinade-result"]
        marinade_details = document["marinade-details"]
        instructions_result = document["instructions-result"]
        
        # é…æ–¹æŒ‰é’®
        recipe_classic = document["recipe-classic"]
        recipe_spicy = document["recipe-spicy"]
        recipe_herbal = document["recipe-herbal"]
        recipe_sweet = document["recipe-sweet"]
        
        # å›¾æ ‡å…ƒç´ 
        icon_monitor = document["icon-monitor"]
        icon_recipe = document["icon-recipe"]
        icon_history = document["icon-history"]
        icon_settings = document["icon-settings"]
        
        # å†å²è®°å½•å­˜å‚¨
        roasting_history = []
        
        # å½“å‰æ¿€æ´»çš„å›¾æ ‡
        active_icon = icon_monitor
        
        # å½“å‰é€‰æ‹©çš„é…æ–¹
        current_recipe = "classic"
        
        def set_active_icon(icon):
            """è®¾ç½®æ¿€æ´»çš„å›¾æ ‡"""
            global active_icon
            
            # ç§»é™¤ä¹‹å‰æ¿€æ´»å›¾æ ‡çš„æ ·å¼
            active_icon.classList.remove("active")
            
            # è®¾ç½®æ–°çš„æ¿€æ´»å›¾æ ‡
            icon.classList.add("active")
            active_icon = icon

        def set_active_recipe(recipe_id):
            """è®¾ç½®æ¿€æ´»çš„é…æ–¹"""
            global current_recipe
            
            # ç§»é™¤æ‰€æœ‰é…æ–¹çš„æ¿€æ´»æ ·å¼
            recipe_classic.classList.remove("active")
            recipe_spicy.classList.remove("active")
            recipe_herbal.classList.remove("active")
            recipe_sweet.classList.remove("active")
            
            # è®¾ç½®æ–°çš„æ¿€æ´»é…æ–¹
            if recipe_id == "classic":
                recipe_classic.classList.add("active")
                current_recipe = "classic"
            elif recipe_id == "spicy":
                recipe_spicy.classList.add("active")
                current_recipe = "spicy"
            elif recipe_id == "herbal":
                recipe_herbal.classList.add("active")
                current_recipe = "herbal"
            elif recipe_id == "sweet":
                recipe_sweet.classList.add("active")
                current_recipe = "sweet"

        def update_time():
            """æ›´æ–°å½“å‰æ—¶é—´æ˜¾ç¤º"""
            now = datetime.now()
            current_time.text = now.strftime("%H:%M")
        
        def calculate_marinade(weight, recipe_type):
            """
            æ ¹æ®é¸¡çš„é‡é‡å’Œé…æ–¹ç±»å‹è®¡ç®—è…Œæ–™é…æ¯”
            """
            if recipe_type == "classic":
                # ç¶“å…¸åŸå‘³é…æ–¹
                return {
                    "salt": round(weight * 0.015, 1),  # é¹½ï¼šé‡é‡çš„1.5%
                    "pepper": round(weight * 0.005, 1),  # é»‘èƒ¡æ¤’ï¼šé‡é‡çš„0.5%
                    "garlic": math.ceil(weight / 500),  # å¤§è’œï¼šæ¯500å…‹1ç“£
                    "olive_oil": round(weight * 0.02, 1),  # æ©„æ¬–æ²¹ï¼šé‡é‡çš„2%
                    "herbs": math.ceil(weight / 1000)  # é¦™è‰ï¼šæ¯1000å…‹1èŒ¶åŒ™
                }
            elif recipe_type == "spicy":
                # é¦™è¾£é¢¨å‘³é…æ–¹
                return {
                    "salt": round(weight * 0.012, 1),  # é¹½ï¼šé‡é‡çš„1.2%
                    "pepper": round(weight * 0.008, 1),  # é»‘èƒ¡æ¤’ï¼šé‡é‡çš„0.8%
                    "garlic": math.ceil(weight / 400),  # å¤§è’œï¼šæ¯400å…‹1ç“£
                    "olive_oil": round(weight * 0.018, 1),  # æ©„æ¬–æ²¹ï¼šé‡é‡çš„1.8%
                    "chili_powder": round(weight * 0.003, 1),  # è¾£æ¤’ç²‰ï¼šé‡é‡çš„0.3%
                    "paprika": round(weight * 0.002, 1),  # ç´…æ¤’ç²‰ï¼šé‡é‡çš„0.2%
                    "cumin": round(weight * 0.001, 1)  # å­œç„¶ï¼šé‡é‡çš„0.1%
                }
            elif recipe_type == "herbal":
                # é¦™è‰è’œé¦™é…æ–¹
                return {
                    "salt": round(weight * 0.014, 1),  # é¹½ï¼šé‡é‡çš„1.4%
                    "pepper": round(weight * 0.004, 1),  # é»‘èƒ¡æ¤’ï¼šé‡é‡çš„0.4%
                    "garlic": math.ceil(weight / 300),  # å¤§è’œï¼šæ¯300å…‹1ç“£
                    "olive_oil": round(weight * 0.025, 1),  # æ©„æ¬–æ²¹ï¼šé‡é‡çš„2.5%
                    "rosemary": math.ceil(weight / 800),  # è¿·è¿­é¦™ï¼šæ¯800å…‹1èŒ¶åŒ™
                    "thyme": math.ceil(weight / 800),  # ç™¾é‡Œé¦™ï¼šæ¯800å…‹1èŒ¶åŒ™
                    "lemon_juice": round(weight * 0.01, 1)  # æª¸æª¬æ±ï¼šé‡é‡çš„1%
                }
            elif recipe_type == "sweet":
                # èœœæ±ç”œå‘³é…æ–¹
                return {
                    "salt": round(weight * 0.01, 1),  # é¹½ï¼šé‡é‡çš„1%
                    "pepper": round(weight * 0.003, 1),  # é»‘èƒ¡æ¤’ï¼šé‡é‡çš„0.3%
                    "garlic": math.ceil(weight / 600),  # å¤§è’œï¼šæ¯600å…‹1ç“£
                    "olive_oil": round(weight * 0.015, 1),  # æ©„æ¬–æ²¹ï¼šé‡é‡çš„1.5%
                    "honey": round(weight * 0.03, 1),  # èœ‚èœœï¼šé‡é‡çš„3%
                    "soy_sauce": round(weight * 0.02, 1),  # é†¬æ²¹ï¼šé‡é‡çš„2%
                    "ginger": round(weight * 0.002, 1)  # è–‘ï¼šé‡é‡çš„0.2%
                }
        
        def calculate_roasting_temperature(weight):
            """æ ¹æ®é‡é‡è®¡ç®—çƒ˜çƒ¤æ¸©åº¦"""
            if weight <= 1000:
                return 200
            elif weight <= 2000:
                return 190
            else:
                return 180
        
        def calculate_roasting_time(weight):
            """æ ¹æ®é‡é‡è®¡ç®—çƒ˜çƒ¤æ—¶é—´"""
            # è®¡ç®—çƒ˜çƒ¤æ—¶é—´ï¼ˆå¤§çº¦æ¯500å…‹éœ€è¦25åˆ†é’Ÿï¼‰
            base_time = 30  # åŸºç¡€æ—¶é—´
            additional_time = (weight / 500) * 25
            return round(base_time + additional_time)
        
        def create_marinade_details(marinade_data):
            """åˆ›å»ºè…Œæ–™è¯¦æƒ…çš„ç½‘æ ¼æ˜¾ç¤º"""
            marinade_details.clear()
            
            for ingredient, amount in marinade_data.items():
                item = document.createElement("div")
                item.className = "marinade-item"
                
                name = document.createElement("div")
                name.className = "marinade-name"
                name.text = ingredient.replace("_", " ").title()
                
                value = document.createElement("div")
                value.className = "marinade-amount"
                
                if ingredient == "garlic":
                    value.text = f"{amount} cloves"
                elif ingredient in ["olive_oil", "lemon_juice", "soy_sauce"]:
                    value.text = f"{amount} ml"
                elif ingredient in ["herbs", "rosemary", "thyme"]:
                    value.text = f"{amount} tsp"
                elif ingredient == "honey":
                    value.text = f"{amount} g"
                else:
                    value.text = f"{amount} g"
                
                item <= name
                item <= value
                marinade_details <= item
        
        def save_to_history(weight, temperature, time, marinade_data, recipe_type):
            """ä¿å­˜è®¡ç®—å‚æ•°åˆ°å†å²è®°å½•"""
            recipe_names = {
                "classic": "Classic Original",
                "spicy": "Spicy Flavor", 
                "herbal": "Herbal Garlic",
                "sweet": "Honey Glazed"
            }
            
            history_entry = {
                "date": datetime.now().strftime("%Y-%m-%d %H:%M"),
                "weight": weight,
                "temperature": temperature,
                "time": time,
                "marinade": marinade_data,
                "recipe_type": recipe_type,
                "recipe_name": recipe_names[recipe_type]
            }
            roasting_history.append(history_entry)
            
            # ä¿å­˜åˆ° localStorage
            window.localStorage.setItem("roastingHistory", JSON.stringify(roasting_history))
        
        def load_from_history():
            """ä» localStorage åŠ è½½å†å²è®°å½•"""
            global roasting_history
            try:
                stored_history = window.localStorage.getItem("roastingHistory")
                if stored_history:
                    roasting_history = JSON.parse(stored_history)
            except:
                roasting_history = []
        
        def format_marinade_summary(marinade_data):
            """æ ¼å¼åŒ–è…Œæ–™æ‘˜è¦ç”¨äºå†å²è®°å½•æ˜¾ç¤º"""
            summary_parts = []
            
            for ingredient, amount in marinade_data.items():
                if ingredient == "garlic":
                    summary_parts.append(f"Garlic {amount} cloves")
                elif ingredient == "olive_oil":
                    summary_parts.append(f"Olive Oil {amount}ml")
                elif ingredient == "honey":
                    summary_parts.append(f"Honey {amount}g")
                elif ingredient == "soy_sauce":
                    summary_parts.append(f"Soy Sauce {amount}ml")
                elif ingredient == "lemon_juice":
                    summary_parts.append(f"Lemon Juice {amount}ml")
                elif ingredient in ["herbs", "rosemary", "thyme"]:
                    summary_parts.append(f"{ingredient.replace('_', ' ').title()} {amount}tsp")
                else:
                    summary_parts.append(f"{ingredient.replace('_', ' ').title()} {amount}g")
            
            return " | ".join(summary_parts)
        
        def display_history():
            """æ˜¾ç¤ºå†å²è®°å½•"""
            history_list.clear()
            
            if len(roasting_history) == 0:
                no_history.style.display = "block"
                history_list <= no_history
            else:
                no_history.style.display = "none"
                for entry in reversed(roasting_history):
                    history_item = document.createElement("div")
                    history_item.className = "history-item"
                    
                    header = document.createElement("div")
                    header.className = "history-header"
                    
                    date = document.createElement("div")
                    date.className = "history-date"
                    date.text = entry["date"]
                    
                    weight = document.createElement("div")
                    weight.className = "history-weight"
                    weight.text = f"{entry['weight']}g Chicken - {entry['recipe_name']}"
                    
                    header <= date
                    header <= weight
                    history_item <= header
                    
                    # æ·»åŠ çƒ˜çƒ¤å‚æ•°
                    params = document.createElement("div")
                    params.style.fontSize = "0.85rem"
                    params.style.marginTop = "8px"
                    params.style.color = "#b8b8b8"
                    params.text = f"Temperature: {entry['temperature']}Â°C | Time: {entry['time']} minutes"
                    history_item <= params
                    
                    # æ·»åŠ è…Œæ–™æ‘˜è¦
                    marinade_div = document.createElement("div")
                    marinade_div.className = "history-marinade"
                    
                    marinade_title = document.createElement("div")
                    marinade_title.style.fontSize = "0.8rem"
                    marinade_title.style.fontWeight = "bold"
                    marinade_title.style.color = "#e43f5a"
                    marinade_title.style.marginBottom = "5px"
                    marinade_title.text = "Marinade Recipe:"
                    marinade_div <= marinade_title
                    
                    marinade_summary = document.createElement("div")
                    marinade_summary.className = "marinade-summary"
                    marinade_summary.text = format_marinade_summary(entry["marinade"])
                    marinade_div <= marinade_summary
                    
                    history_item <= marinade_div
                    history_list <= history_item
        
        def show_main_view():
            """æ˜¾ç¤ºä¸»ç”»é¢"""
            results_div.style.display = "block"
            history_section.style.display = "none"
            history_btn.style.display = "block"
            back_btn.style.display = "none"
            set_active_icon(icon_monitor)
        
        def show_history_view():
            """æ˜¾ç¤ºå†å²è®°å½•ç”»é¢"""
            results_div.style.display = "none"
            history_section.style.display = "block"
            history_btn.style.display = "none"
            back_btn.style.display = "block"
            display_history()
            set_active_icon(icon_history)
        
        def calculate_handler(evt):
            """å¤„ç†è®¡ç®—æŒ‰é’®ç‚¹å‡»"""
            try:
                weight = float(chicken_weight_input.value)
                
                if weight < 500 or weight > 5000:
                    error_message.style.display = "block"
                    return
                
                # éšè—é”™è¯¯æ¶ˆæ¯
                error_message.style.display = "none"
                
                # è®¡ç®—ç»“æœ
                marinade_data = calculate_marinade(weight, current_recipe)
                temperature = calculate_roasting_temperature(weight)
                time = calculate_roasting_time(weight)
                
                # æ˜¾ç¤ºè…Œæ–™ç»“æœ
                recipe_names = {
                    "classic": "Classic Original",
                    "spicy": "Spicy Flavor",
                    "herbal": "Herbal Garlic", 
                    "sweet": "Honey Glazed"
                }
                
                marinade_text = f"For {weight}g chicken, using {recipe_names[current_recipe]} recipe:"
                marinade_result.text = marinade_text
                
                # åˆ›å»ºè¯¦ç»†çš„è…Œæ–™æ˜¾ç¤º
                create_marinade_details(marinade_data)
                
                # æ˜¾ç¤ºè¯´æ˜
                instructions = f"1. Prepare marinade: Mix all ingredients thoroughly\n2. Marinate chicken: Apply marinade evenly to chicken, marinate for at least 2 hours (preferably overnight)\n3. Preheat oven: Preheat oven to {temperature}Â°C\n4. Roasting time: Place chicken in oven, roast for {time} minutes\n5. Check doneness: Use thermometer to check if internal temperature reaches 74Â°C\n6. Rest: Let chicken rest for 10 minutes before carving and serving"
                instructions_result.text = instructions
                
                # ä¿å­˜åˆ°å†å²è®°å½•
                save_to_history(weight, temperature, time, marinade_data, current_recipe)
                
            except ValueError:
                error_message.style.display = "block"
        
        # æŒ‰é’®äº‹ä»¶å¤„ç†
        def start_handler(evt):
            window.alert("Start roasting function")
        
        def temp_handler(evt):
            window.alert("Temperature adjustment function")
        
        def timer_handler(evt):
            window.alert("Timer setting function")
        
        def recipe_handler(evt):
            window.alert("Recipe viewing function")
        
        def history_handler(evt):
            show_history_view()
        
        def back_handler(evt):
            show_main_view()
        
        # é…æ–¹é€‰æ‹©äº‹ä»¶
        def classic_handler(evt):
            set_active_recipe("classic")
        
        def spicy_handler(evt):
            set_active_recipe("spicy")
        
        def herbal_handler(evt):
            set_active_recipe("herbal")
        
        def sweet_handler(evt):
            set_active_recipe("sweet")
        
        # å›¾æ ‡ç‚¹å‡»äº‹ä»¶
        def monitor_handler(evt):
            show_main_view()
            window.alert("Entering monitoring mode")
        
        def recipe_icon_handler(evt):
            set_active_icon(icon_recipe)
            window.alert("Entering recipe management")
        
        def history_icon_handler(evt):
            show_history_view()
        
        def settings_handler(evt):
            set_active_icon(icon_settings)
            window.alert("Entering system settings")
        
        # ç»‘å®šäº‹ä»¶
        calculate_btn.bind("click", calculate_handler)
        document["start-btn"].bind("click", start_handler)
        document["temp-btn"].bind("click", temp_handler)
        document["timer-btn"].bind("click", timer_handler)
        document["recipe-btn"].bind("click", recipe_handler)
        history_btn.bind("click", history_handler)
        back_btn.bind("click", back_handler)
        
        # ç»‘å®šé…æ–¹é€‰æ‹©äº‹ä»¶
        recipe_classic.bind("click", classic_handler)
        recipe_spicy.bind("click", spicy_handler)
        recipe_herbal.bind("click", herbal_handler)
        recipe_sweet.bind("click", sweet_handler)
        
        # ç»‘å®šå›¾æ ‡ç‚¹å‡»äº‹ä»¶
        icon_monitor.bind("click", monitor_handler)
        icon_recipe.bind("click", recipe_icon_handler)
        icon_history.bind("click", history_icon_handler)
        icon_settings.bind("click", settings_handler)
        
        # åˆå§‹åŒ–
        def initialize():
            # æ›´æ–°æ—¶é—´
            update_time()
            timer.set_interval(update_time, 60000)  # æ¯åˆ†é’Ÿæ›´æ–°ä¸€æ¬¡
            
            # åŠ è½½å†å²è®°å½•
            load_from_history()
            
            # è®¾ç½®åˆå§‹é…æ–¹
            set_active_recipe("classic")
        
        # å¯åŠ¨åˆå§‹åŒ–
        initialize()
    </script>
</body>
</html>